local:
  python: python --version
  helm: helm version --short
  kubectl: kubectl version --client=true --short
  docker: docker version --format json
  astro: astro version
  docker-compose: docker-compose --version
  os: uname -a

local_cloud:
  aws: aws --version
  gcp: gcloud version --format=json
  az: az version

kubernetes:
  cluster_size:
    cmd: kubectl get nodes -o json
    jmespath: items[].status.capacity

  provider:
    cmd: kubectl version -o json
    jmespath: serverVersion.gitVersion
    tranformer: transformers.cloud_provider

  version:
    cmd: kubectl version -o json
    jmespath: serverVersion

# https://docs.google.com/document/d/1yYTxkhfpRRrhcgjUN8YP3pYKNLDGmnYazAGNgZuhrNI/edit
airflow:
  report:
  - /bin/sh
  - -c
  - curl -ssl https://raw.githubusercontent.com/fritz-astronomer/telescope/json/airflow_debug_report.py | PYTHONWARNINGS=ignore OUTPUT_FILENAME=- python
preinstall:
#  database: rf"""kubectl run psql --rm -it --restart=Never -n {namespace} --image {image} --command -- psql {conn.out} -qtc "select 'healthy';" """
#  certificate: ""

postinstall:
  helm: helm ls -aA -o json
  astro_config: cat config.yaml
